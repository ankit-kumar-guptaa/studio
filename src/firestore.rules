rules_version = '2';

function isSignedIn() {
  return request.auth != null;
}

function isSuperAdmin() {
  return request.auth.token.email == 'support@itsahayata.com';
}

function isOwner(userId) {
  return request.auth.uid == userId;
}

service cloud.firestore {
  match /databases/{database}/documents {
    
    match /jobSeekers/{userId} {
      allow read: if true;
      allow create: if isSignedIn();
      allow update, delete: if isOwner(userId) || isSuperAdmin();
    }
    
    match /employers/{userId} {
      allow read: if true;
      allow create: if isSignedIn();
      allow update, delete: if isOwner(userId) || isSuperAdmin();
    }
    
    match /seoManagers/{managerId} {
      allow read: if true; // Allow reading for login check
      allow write: if isSuperAdmin(); // Only super admin can create/delete
    }

    match /jobPosts/{jobId} {
      allow read: if true;
      allow create, update, delete: if isSuperAdmin();
    }

    match /employers/{employerId}/jobPosts/{jobId} {
      allow read: if true;
      allow write: if isOwner(employerId) || isSuperAdmin();
    }

    match /blogs/{blogId} {
      allow read: if true;
      allow create, update, delete: if isSuperAdmin();
    }

    // Default catch-all for any other path
    match /{document=**} {
      allow read: if true;
      allow write: if isSignedIn();
    }
  }
}
